[架构](https://github.com/android/nowinandroid/blob/main/docs/ArchitectureLearningJourney.md)
架构概述 #架构
有两层：数据层和用户界面层
遵循单向数据流的反应式编程。数据层位于底部
![[Pasted image 20220517211528.png]]
高层对低层的变化做出反应。
事件向下流动。
数据向上流动。
数据流使用流来实现，使用Kotlin Flows实现。

---
# 例子1
在屏幕上显示新闻当应用程序首次运行时，它将尝试从远程服务器加载一个新闻资源列表，一旦加载完毕，这些资源就会根据用户选择的兴趣显示给他们。
![[Pasted image 20220517212411.png]]
## 数据层
被实现为应用程序数据和业务逻辑的离线第一来源。它是应用程序中所有数据的真实来源。
![[Pasted image 20220518215553.png]]
每个资源库都有自己的模型。
Repositories是其他层的公共API，它们提供了访问应用程序数据的唯一途径。存储库通常提供一个或多个方法来读写数据。
### 读取数据
数据是以数据流的形式暴露的。这意味着存储库的每个客户端必须准备好对数据变化做出反应。数据不以快照的形式暴露（如getModel），因为不能保证它在使用时仍然有效。
### 写入数据
为了写入数据，存储库提供了suspend功能。这取决于调用者是否确保它们的执行有适当的范围。
### 数据同步
存储库负责将本地存储的数据与远程来源的数据进行协调。一旦从远程数据源获得数据，它将立即写入本地存储。更新后的数据从本地存储（Room）发射到相关的数据流中，由任何监听的客户端接收
## UI 层
- 使用Compose构建的UI元素
- 安卓ViewModels
ViewModels从存储库接收数据流，并将其转换为UI状态。UI元素反映了这种状态，并为用户提供了与应用程序交互的方式。这些交互被作为事件传递给试图模型，在那里被处理。
![[Pasted image 20220519232159.png]]
通过数据流的转换来传输。这种方法可以确保。
UI状态总是代表底层的应用程序数据-应用程序数据是真实的来源。UI元素处理所有可能的状态。